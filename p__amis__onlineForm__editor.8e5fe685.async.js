"use strict";(self.webpackChunkquick_admin=self.webpackChunkquick_admin||[]).push([[9041],{88530:function(Ge,de,r){r.d(de,{FG:function(){return ge},Xv:function(){return U},bF:function(){return xe},nC:function(){return A},nY:function(){return Fe}});var he=r(15009),h=r.n(he),me=r(97857),m=r.n(me),ye=r(99289),I=r.n(ye),Y=r(12578);function A(O,T){return D.apply(this,arguments)}function D(){return D=I()(h()().mark(function O(T,L){return h()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,Y.request)("/api/online/form/getFormById",m()({method:"GET",params:{id:T}},L||{})));case 1:case"end":return x.stop()}},O)})),D.apply(this,arguments)}function U(O,T){return G.apply(this,arguments)}function G(){return G=I()(h()().mark(function O(T,L){return h()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,Y.request)("/api/online/form/getFormSchemaById",m()({method:"GET",params:m()({},T)},L||{})));case 1:case"end":return x.stop()}},O)})),G.apply(this,arguments)}function ge(O,T){return Q.apply(this,arguments)}function Q(){return Q=I()(h()().mark(function O(T,L){return h()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,Y.request)("/api/online/form/updateById",m()({method:"PUT",data:T},L||{})));case 1:case"end":return x.stop()}},O)})),Q.apply(this,arguments)}function xe(O,T){return H.apply(this,arguments)}function H(){return H=I()(h()().mark(function O(T,L){return h()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,Y.request)("/api/online/form/updateSchemaById",m()({method:"PUT",headers:{"Content-Type":"multipart/form-data"},data:T},L||{})));case 1:case"end":return x.stop()}},O)})),H.apply(this,arguments)}function Fe(O,T){return q.apply(this,arguments)}function q(){return q=I()(h()().mark(function O(T,L){return h()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",(0,Y.request)("/api/online/form/publishForm",m()({method:"PUT",data:m()({status:"2"},T)},L||{})));case 1:case"end":return x.stop()}},O)})),q.apply(this,arguments)}},2277:function(Ge,de,r){r.r(de),r.d(de,{default:function(){return Pt}});var he=r(97857),h=r.n(he),me=r(15009),m=r.n(me),ye=r(99289),I=r.n(ye),Y=r(5574),A=r.n(Y),D=r(67294),U=r(12578),G=r(88530);function ge(t,n){return Q.apply(this,arguments)}function Q(){return Q=I()(m()().mark(function t(n,l){return m()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,U.request)("/v1/flow/queryFlow",h()({method:"POST",data:n},l||{})));case 1:case"end":return a.stop()}},t)})),Q.apply(this,arguments)}function xe(t,n){return H.apply(this,arguments)}function H(){return H=I()(m()().mark(function t(n,l){return m()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,U.request)("/v1/flow/createFlow",h()({method:"POST",data:n},l||{})));case 1:case"end":return a.stop()}},t)})),H.apply(this,arguments)}function Fe(t,n){return q.apply(this,arguments)}function q(){return q=I()(m()().mark(function t(n,l){return m()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,U.request)("/v1/flow/saveFlowModel",h()({method:"POST",data:n},l||{})));case 1:case"end":return a.stop()}},t)})),q.apply(this,arguments)}function O(t,n){return T.apply(this,arguments)}function T(){return T=I()(m()().mark(function t(n,l){return m()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,U.request)("/v1/flow/deployFlow",h()({method:"POST",data:n},l||{})));case 1:case"end":return a.stop()}},t)})),T.apply(this,arguments)}var L=r(9117),se=r(47448),x=r(54152),_=r(4881),Je=r(20640),Ke=r.n(Je),$t=r(53370),Ut=r(21595),Wt=r(74508),Gt=r(5471),J=r(2453),Ne=r(97280),K=r(14726),z=r(4393),Ve=r(71230),Pe=r(15746),ze=r(32983),Jt=r(91441),Kt=r(67643),Vt=r(5646),Xe=r(13769),Te=r.n(Xe),Ye=r(92783),k=r(59782),Qe=r.n(k),ee=r(40741),ce=r(61720),je=r(25921),He=[{type:"apply",label:"\u7533\u8BF7",style:{width:"30px",height:"30px",borderRadius:"15px",border:"2px solid #FF6347"},property:{username:"",time:"",startTime:"",endTime:""}},{type:"approver",label:"\u5BA1\u6279",style:{width:"50px",height:"40px",borderRadius:"4px",border:"2px solid #3CB371"},property:{assignee_id:"",approval_type:""}},{type:"jugement",label:"\u5224\u65AD",style:{width:"30px",height:"30px",border:"2px solid #6495ED",transform:"rotate(45deg)"}},{type:"finish",label:"\u7ED3\u675F",style:{width:"30px",height:"30px",borderRadius:"15px",border:"2px solid #FF6347"}}],qe=[{label:"\u6216\u7B7E",value:"A"},{label:"\u4F1A\u7B7E",value:"B"}],_e=[{label:"\u5F20\u4E09",value:"05e948bee2034e19ac5a0992d0866ccf"},{label:"\u674E\u56DB",value:"05e948bee2034e19ac5a0992d0866cc2"}],zt=[{label:"\u76F4\u63A5\u4E0A\u7EA7",value:"leader"},{label:"T3\u9886\u5BFC",value:"t3Leader"},{label:"T2\u9886\u5BFC",value:"t2Leader"},{label:"T1\u9886\u5BFC",value:"t1Leader"}],et={rect:{radius:8,stroke:"#3CB371"},circle:{r:25,stroke:"#FF6347"},polygon:{stroke:"#6495ED"},polyline:{strokeWidth:1},edgeText:{background:{fill:"white"}}},Xt={nodes:[{id:"28df2fbe-f32b-4a9b-b544-7e70d7187b33",type:"apply",x:210,y:210,text:{x:210,y:210,value:"\u7533\u8BF7"},properties:{}},{id:"64179bd7-c60e-433c-8df7-97c8e98f855d",type:"approver",x:350,y:210,text:{x:350,y:210,value:"\u5BA1\u6279"},properties:{labelColor:"#000000",approveTypeLabel:"\u76F4\u63A5\u4E0A\u7EA7",approveType:"leader"}},{id:"fcb96f10-720e-40e5-8ed0-ebdd0a46f234",type:"jugement",x:510,y:210,text:{x:510,y:210,value:`\u5224\u65AD\u62A5\u9500\u662F\u5426
\u5927\u4E8E1000\u5143`},properties:{api:""}},{id:"9f119df3-c449-4e5d-a67a-cb351b9cbdb5",type:"approver",x:670,y:210,text:{x:670,y:210,value:"\u5BA1\u6279"},properties:{labelColor:"#000000",approveTypeLabel:"T2\u9886\u5BFC",approveType:"t2Leader"}},{id:"ef34f09c-38ea-4ad4-acd2-cc2f464a2be6",type:"finsh",x:850,y:210,text:{x:850,y:210,value:"\u7ED3\u675F"},properties:{}}],edges:[{id:"0d87b1eb-2389-445a-9f34-6227940b2072",type:"polyline",sourceNodeId:"28df2fbe-f32b-4a9b-b544-7e70d7187b33",targetNodeId:"64179bd7-c60e-433c-8df7-97c8e98f855d",startPoint:{x:235,y:210},endPoint:{x:300,y:210},text:{x:51.25,y:0,value:""},properties:{},pointsList:[{x:235,y:210},{x:300,y:210}]},{id:"d99e7451-b379-411e-b0da-df11be8be20a",type:"polyline",sourceNodeId:"64179bd7-c60e-433c-8df7-97c8e98f855d",targetNodeId:"fcb96f10-720e-40e5-8ed0-ebdd0a46f234",startPoint:{x:400,y:210},endPoint:{x:475,y:210},text:{x:437.5,y:210,value:"\u901A\u8FC7"},properties:{},pointsList:[{x:400,y:210},{x:475,y:210}]},{id:"4c615802-15d8-442c-be22-b65430286123",type:"polyline",sourceNodeId:"fcb96f10-720e-40e5-8ed0-ebdd0a46f234",targetNodeId:"9f119df3-c449-4e5d-a67a-cb351b9cbdb5",startPoint:{x:545,y:210},endPoint:{x:620,y:210},text:{x:582.5,y:210,value:"\u662F"},properties:{},pointsList:[{x:545,y:210},{x:620,y:210}]},{id:"934ae03a-6ee0-4568-a2b4-8bcede565e0b",type:"polyline",sourceNodeId:"9f119df3-c449-4e5d-a67a-cb351b9cbdb5",targetNodeId:"ef34f09c-38ea-4ad4-acd2-cc2f464a2be6",startPoint:{x:720,y:210},endPoint:{x:825,y:210},text:{x:-10,y:0,value:""},properties:{},pointsList:[{x:720,y:210},{x:825,y:210}]},{id:"bd5e1dd0-1978-46f7-851b-d31c03aebee9",type:"polyline",sourceNodeId:"64179bd7-c60e-433c-8df7-97c8e98f855d",targetNodeId:"ef34f09c-38ea-4ad4-acd2-cc2f464a2be6",startPoint:{x:350,y:170},endPoint:{x:850,y:185},text:{x:600,y:140,value:"\u9A73\u56DE"},properties:{},pointsList:[{x:350,y:170},{x:350,y:140},{x:850,y:140},{x:850,y:185}]},{id:"453139c3-faa1-4e3a-a413-38f251243baa",type:"polyline",sourceNodeId:"fcb96f10-720e-40e5-8ed0-ebdd0a46f234",targetNodeId:"ef34f09c-38ea-4ad4-acd2-cc2f464a2be6",startPoint:{x:510,y:245},endPoint:{x:850,y:235},text:{x:680,y:275,value:"\u5426"},properties:{},pointsList:[{x:510,y:245},{x:510,y:275},{x:850,y:275},{x:850,y:235}]}]},tt=r(85265),e=r(85893),rt=["apply","approver","jugement","polyline"];function nt(t){var n=t.nodeData,l=t.onClose,o=t.onUpdate,a=D.useState(),u=A()(a,2),i=u[0],d=u[1],s=ee.Z.useForm(),F=A()(s,1),c=F[0];D.useEffect(function(){n&&d({title:n.type==="polyline"?"\u5224\u65AD":n==null?void 0:n.text.value,type:n.type,properties:n.properties})},[n]);var f=function(w){o(n==null?void 0:n.id,{properties:w,text:w["text-value"]}),l()},g=function(){return(0,e.jsx)("div",{style:{textAlign:"right"},children:(0,e.jsx)(K.ZP,{type:"primary",onClick:c.submit,children:"\u63D0\u4EA4"})})},j=function(w){w||(c.resetFields(),d(void 0))},M=function(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ee.Z.Item,{label:"\u5BA1\u6279\u7C7B\u578B",name:"approval_type",children:(0,e.jsx)(ce.Z,{options:qe})}),(0,e.jsx)(ee.Z.Item,{label:"\u5BA1\u6279\u4EBA",name:"assignee_id",children:(0,e.jsx)(ce.Z,{showSearch:!0,allowClear:!0,options:_e})})]})},E=function(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ee.Z.Item,{label:"\u53D8\u91CF\u540D\u79F0",name:"api",children:(0,e.jsx)(je.Z,{})})})},C=function(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ee.Z.Item,{label:"\u540D\u79F0",name:"text-value",children:(0,e.jsx)(je.Z,{})}),(0,e.jsx)(ee.Z.Item,{label:"\u8868\u8FBE\u5F0F",name:"conditionsequenceflow",children:(0,e.jsx)(je.Z,{})})]})},B=function(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(ee.Z,{form:c,labelCol:{span:6},wrapperCol:{span:16},style:{maxWidth:600},autoComplete:"off",onFinish:f,initialValues:n==null?void 0:n.properties,children:[(i==null?void 0:i.type)==="approver"&&M(),(i==null?void 0:i.type)==="jugement"&&E(),(i==null?void 0:i.type)==="polyline"&&C()]})})};console.log(n,n==null?void 0:n.type);var X=function(){return rt.includes((i==null?void 0:i.type)||"")?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(tt.Z,{mask:!0,title:i==null?void 0:i.title,open:!!n,width:500,onClose:l,afterOpenChange:j,footer:(0,e.jsx)(g,{}),children:(0,e.jsx)(B,{})})}):(0,e.jsx)(e.Fragment,{})};return X()}function at(t){var n=function(a){t.dnd.startDrag({type:a.type,text:a.label})},l=function(){var a=[];return He.forEach(function(u,i){a.push((0,e.jsxs)("div",{className:"approve-node node-".concat(u.type),children:[(0,e.jsx)("div",{className:"node-shape",style:h()({},u.style),onMouseDown:function(){return n(u)}}),(0,e.jsx)("div",{className:"node-label",children:u.label})]},i))}),a};return l()}var st=r(9783),Ie=r.n(st),ot=r(12444),re=r.n(ot),it=r(72004),ne=r.n(it),lt=r(28785),pe=r.n(lt),ut=r(48374),fe=r.n(ut),dt=r(31996),oe=r.n(dt),ct=r(26037),ie=r.n(ct);function pt(t){var n=function(i){oe()(s,i);var d=ie()(s);function s(){return re()(this,s),d.apply(this,arguments)}return ne()(s,[{key:"getConnectedSourceRules",value:function(){var c=pe()(fe()(s.prototype),"getConnectedSourceRules",this).call(this);return c.push({message:"\u5F00\u59CB\u8282\u70B9\u53EA\u80FD\u8FDE\u63A5\u4E00\u6761\u8FB9\uFF01",validate:function(g){var j=g==null?void 0:g.graphModel.getNodeOutgoingEdge(g.id);return(j==null?void 0:j.length)===0}}),c}},{key:"getConnectedTargetRules",value:function(){var c=pe()(fe()(s.prototype),"getConnectedTargetRules",this).call(this),f={message:"\u5F00\u59CB\u8282\u70B9\u53EA\u80FD\u8FDE\u51FA\uFF0C\u4E0D\u80FD\u8FDE\u5165\uFF01",validate:function(j,M){return!M}};return c.push(f),c}}]),s}(k.CircleNodeModel);t.register({type:"apply",view:k.CircleNode,model:n});var l=function(i){oe()(s,i);var d=ie()(s);function s(){return re()(this,s),d.apply(this,arguments)}return ne()(s,[{key:"getShape",value:function(){var c=this.props.model,f=c.x,g=c.y,j=c.width,M=c.height,E=c.radius,C=this.props.model.getNodeStyle();return(0,k.h)("g",{},[(0,k.h)("rect",h()(h()({},C),{},{x:f-j/2,y:g-M/2,rx:E,ry:E,width:j,height:M}))])}}]),s}(k.RectNode);Ie()(l,"extendKey","UserTaskNode");var o=function(i){oe()(s,i);var d=ie()(s);function s(F,c){var f;return re()(this,s),f=d.call(this,F,c),f.properties=Object.assign({labelColor:"#000000",approval_type:"",assignee_id:""},f.getProperties()),f}return ne()(s,[{key:"getConnectedSourceRules",value:function(){var c=pe()(fe()(s.prototype),"getConnectedSourceRules",this).call(this);return c.push({message:"\u5BA1\u6279\u8282\u70B9\u53EA\u80FD\u8FDE\u63A5\u4E00\u6761\u8FB9\uFF01",validate:function(g){var j=g==null?void 0:g.graphModel.getNodeOutgoingEdge(g.id);return(j==null?void 0:j.length)===0}}),c}}]),s}(k.RectNodeModel);t.register({type:"approver",view:l,model:o});var a=function(i){oe()(s,i);var d=ie()(s);function s(F,c){var f;return re()(this,s),f=d.call(this,F,c),f.points=[[35,0],[70,35],[35,70],[0,35]],f.properties={api:""},f}return ne()(s)}(k.PolygonNodeModel);t.register({type:"jugement",view:k.PolygonNode,model:a});var u=function(i){oe()(s,i);var d=ie()(s);function s(){return re()(this,s),d.apply(this,arguments)}return ne()(s,[{key:"getConnectedSourceRules",value:function(){var c=pe()(fe()(s.prototype),"getConnectedSourceRules",this).call(this),f={message:"\u7ED3\u675F\u8282\u70B9\u53EA\u80FD\u8FDE\u5165\uFF0C\u4E0D\u80FD\u8FDE\u51FA\uFF01",validate:function(j){return!j}};return c.push(f),c}}]),s}(k.CircleNodeModel);t.register({type:"finish",view:k.CircleNode,model:u})}var Yt=r(10114),Me=r(22913),ae={SEQUENCE_FLOW:1,START_EVENT:2,END_EVENT:3,USER_TASK:4,EXCLUSIVE_GATEWAY:6},Ze={1:"polyline",2:"apply",3:"finish",4:"approver",6:"jugement"};function Ae(t){switch(t){case"polyline":return ae.SEQUENCE_FLOW;case"apply":return ae.START_EVENT;case"finish":return ae.END_EVENT;case"approver":return ae.USER_TASK;case"jugement":return ae.EXCLUSIVE_GATEWAY;default:return t}}function ft(t){var n=t.id,l=t.type,o=t.x,a=t.y,u=t.text,i=u===void 0?"":u,d=t.properties;return{incoming:[],outgoing:[],dockers:[],type:Ae(t.type),properties:h()(h()({},d),{},{name:i&&i.value||"",x:o,y:a,text:i}),key:n}}function vt(t){var n=t.id,l=t.type,o=t.sourceNodeId,a=t.targetNodeId,u=t.startPoint,i=t.endPoint,d=t.pointsList,s=t.text,F=s===void 0?"":s,c=t.properties;return{incoming:[o],outgoing:[a],type:Ae(l),dockers:[],properties:h()(h()({},c),{},{name:F&&F.value||"",text:F,startPoint:JSON.stringify(u),endPoint:JSON.stringify(i),pointsList:JSON.stringify(d)}),key:n}}function Oe(t){if(t.flowElementList)return t;var n=new Map,l={flowElementList:[]};return t.nodes.forEach(function(o){var a=ft(o);l.flowElementList.push(a),n.set(o.id,a)}),t.edges.forEach(function(o){var a=vt(o),u=n.get(o.sourceNodeId);u.outgoing.push(a.key);var i=n.get(o.targetNodeId);i.incoming.push(a.key),l.flowElementList.push(a)}),l}function ht(t){var n=t.incoming,l=t.outgoing,o=t.properties,a=t.key,u=t.type,i=o.text,d=o.name,s=o.startPoint,F=o.endPoint,c=o.pointsList,f={id:a,type:Ze[u],sourceNodeId:n[0],targetNodeId:l[0],text:i||d,properties:{}};s&&(f.startPoint=JSON.parse(s)),F&&(f.endPoint=JSON.parse(F)),c&&(f.pointsList=JSON.parse(c));var g=["startPoint","endPoint","pointsList","text"];return Object.keys(t.properties).forEach(function(j){g.indexOf(j)===-1&&(f.properties[j]=t.properties[j])}),f}function mt(t){var n=t.properties,l=t.key,o=t.type,a=t.bounds,u=n.x,i=n.y,d=n.text;if(u===void 0){var s=A()(a,2),F=s[0],c=F.x,f=F.y,g=s[1],j=g.x,M=g.y;u=(c+j)/2,i=(f+M)/2}var E={id:l,type:Ze[o],x:u,y:i,text:d,properties:{}},C=["x","y","text"];return Object.keys(t.properties).forEach(function(B){C.indexOf(B)===-1&&(E.properties[B]=t.properties[B])}),E}function Be(t){if(!t.flowElementList)return t;var n={nodes:[],edges:[]},l=t.flowElementList;return l&&l.length>0&&l.forEach(function(o){if(o.type===ae.SEQUENCE_FLOW){var a=ht(o);n.edges.push(a)}else{var u=mt(o);n.nodes.push(u)}}),n}var Re=function(){function t(n){var l=this,o=n.lf;re()(this,t),o.adapterIn=this.adapterIn,o.adapterOut=this.adapterOut;var a=o.renderRawData.bind(o);o.renderRawData=function(u){return a(l.adapterIn(u))}}return ne()(t,[{key:"adapterOut",value:function(l){if(l)return Oe(l)}},{key:"adapterIn",value:function(l){var o=l;if(o)return typeof o=="string"&&(o=JSON.parse(o)),Be(o)}}]),t}();Ie()(Re,"pluginName","turboAdapter");var yt=Re,gt=["children"],xt={stopScrollGraph:!0,stopZoomGraph:!0,grid:{size:10,visible:!0,type:"mesh",config:{color:"#DCDCDC"}},keyboard:{enabled:!0},style:et};function Ft(t){var n=t.flowData,l=t.changeFlowModel,o=(0,D.useState)({}),a=A()(o,2),u=a[0],i=a[1],d=(0,D.useState)(),s=A()(d,2),F=s[0],c=s[1],f=(0,U.useParams)();(0,D.useEffect)(function(){var y=new(Qe())(h()(h()({},xt),{},{container:document.querySelector("#graph"),plugins:[yt]}));i(y),pt(y),y.render(n==null?void 0:n.flowModel),g(y)},[]);var g=function(w){w.on("element:click",function(W){var te=W.data;c(te)}),w.on("connection:not-allowed",function(W){J.ZP.error(W.msg)}),l&&w.on("history:change",function(){l(JSON.stringify(w.getGraphData()))})},j=function(w,W){var te=W.properties,S=W.text;te&&u.setProperties(w,te),S&&u.updateText(w,S)},M=[{value:"editor",label:"\u6D41\u7A0B\u8BBE\u8BA1\u5668",children:function(w){return(0,e.jsxs)("div",{className:"approve-example-container",hidden:!w,children:[(0,e.jsx)("div",{className:"node-panel",children:at(u)}),(0,e.jsx)("div",{id:"graph",className:"viewport"})]},"editor")}},{value:"logic-flow-data",label:"\u6D41\u7A0B JSON",children:function(w){return(0,e.jsx)("div",{className:"approve-example-container",hidden:!w,children:(0,e.jsx)(Me.Z,{style:{height:"100%"},value:u.getGraphData&&JSON.stringify(Be(u.getGraphData()),null,4)})},"logic-flow-data")}},{value:"turbo-data",label:"Turbo JSON",children:function(w){return(0,e.jsx)("div",{className:"approve-example-container",hidden:!w,children:(0,e.jsx)(Me.Z,{style:{height:"100%"},value:u.getGraphData&&JSON.stringify(Oe(u.getGraphData()),null,4)})},"turbo-data")}}],E=(0,D.useState)(M[0].value),C=A()(E,2),B=C[0],X=C[1];return(0,e.jsxs)("div",{className:"flow-editor",children:[(0,e.jsxs)("div",{className:"flow-editor-header",children:[(0,e.jsx)(K.ZP.Group,{}),(0,e.jsx)(Ye.Z,{value:B,options:M.map(function(y){var w=y.children,W=Te()(y,gt);return W}),onChange:function(w){return X(w)}})]}),(0,e.jsxs)("div",{className:"approve-example-container",children:[M.map(function(y){return y.children(y.value===B)}),(0,e.jsx)(nt,{nodeData:F,onClose:function(){return c(void 0)},onUpdate:j})]})]})}var jt=r(34991),ve=r(86250),bt=["extra"];function Et(t){var n=t.steps,l=n===void 0?[]:n,o=t.onChange,a=t.current,u=t.renderExtra,i=u===void 0?function(E){return E}:u,d=l.map(function(E,C){var B=E.extra,X=Te()(E,bt);return h()(h()({},X),{},{index:C})}),s=D.useState(d[0]||{}),F=A()(s,2),c=F[0],f=F[1];D.useEffect(function(){var E=d.find(function(C){return C.key===a});E&&f(E)},[a]);var g=function(){return(0,e.jsx)(jt.Z,{type:"navigation",size:"small",current:c.index,onChange:function(B){o(d[B].key)},className:"site-navigation-steps",items:d})},j=function(){var C;return i((C=l.find(function(B){return B.key===c.key}))===null||C===void 0?void 0:C.extra)},M=function(){return(0,e.jsxs)("div",{className:"Editor-header",children:[(0,e.jsx)("div",{className:"Editor-title",children:"\u8868\u5355\u7F16\u8F91\u5668"}),(0,e.jsx)("div",{className:"Editor-view-mode-group-container step-bar",children:g()}),(0,e.jsx)("div",{className:"Editor-header-actions",children:(0,e.jsx)(ve.Z,{gap:"small",wrap:"wrap",children:j()})})]})};return M()}var wt=r(78741),le=r(29789),be=r(23935),Ct=r(72269),St={"anchor-menu":"anchor-menu___iAScK","anchor-menu-item":"anchor-menu-item___mgvKv"};function Dt(t){var n=t.container,l=[{key:"submit-setting",href:"#submit-setting",title:"\u63D0\u4EA4\u8BBE\u7F6E"},{key:"alert-setting",href:"#alert-setting",title:"\u63D0\u9192\u8BBE\u7F6E"}],o=function(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:St["anchor-menu"],children:(0,e.jsx)(z.Z,{bordered:!1,children:(0,e.jsx)(wt.Z,{affix:!1,getContainer:function(){return n},items:l})})})})},a=function(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{id:"submit-setting",style:{fontSize:26,fontWeight:900,paddingTop:20},children:"\u63D0\u4EA4\u9650\u5236"}),(0,e.jsxs)(z.Z,{title:"\u7533\u8BF7\u63D0\u4EA4\u91CF\u9650\u5236",bordered:!1,style:{width:"100%"},children:[(0,e.jsx)(le.Z,{onChange:function(){},children:"\u9650\u5236\u63D0\u4EA4\u603B\u91CF"}),(0,e.jsx)("br",{}),(0,e.jsx)(le.Z,{onChange:function(){},children:"\u9650\u5236\u6BCF\u6708\u63D0\u4EA4\u4E0A\u9650"})]}),(0,e.jsx)("br",{}),(0,e.jsx)(z.Z,{title:"\u7533\u8BF7\u901A\u9053\u5B9A\u65F6\u5F00\u542F/\u5173\u95ED",bordered:!1,style:{width:"100%"},children:(0,e.jsx)(le.Z,{onChange:function(){},children:"\u5F00\u542F/\u5173\u95ED\u65F6\u95F4"})}),(0,e.jsx)("br",{}),(0,e.jsx)(z.Z,{title:"\u7533\u8BF7\u4EBA\u586B\u5199\u8868\u5355\u540E\u663E\u793A",bordered:!1,style:{width:"100%"},children:(0,e.jsx)(ce.Z,{style:{width:300},value:"default",options:[{value:"default",label:"\u9ED8\u8BA4\u6587\u6848"}]})}),(0,e.jsx)("br",{}),(0,e.jsx)(z.Z,{title:"\u7533\u8BF7\u4EBA\u6682\u5B58\u6570\u636E\u540E",bordered:!1,style:{width:"100%"},children:(0,e.jsx)(ce.Z,{style:{width:300},value:"default",options:[{value:"default",label:"\u8DF3\u8F6C\u7CFB\u7EDF\u9ED8\u8BA4\u94FE\u63A5"}]})}),(0,e.jsx)("p",{id:"alert-setting",style:{fontSize:26,fontWeight:900,paddingTop:20},children:"\u63D0\u9192\u8BBE\u7F6E"}),(0,e.jsx)(z.Z,{bordered:!1,children:(0,e.jsx)(be.Z,{dataSource:[{key:"",title:"\u5F85\u529E\u4E8B\u9879",subTitle:"\u5F53\u8282\u70B9\u6709\u65B0\u7684\u5F85\u529E\u4E8B\u9879\u65F6\uFF08\u5305\u542B\u63D0\u4EA4\uFF09\uFF0C\u5BF9\u8BE5\u8282\u70B9\u8D1F\u8D23\u4EBA\u8FDB\u884C\u63D0\u9192"},{key:"",title:"\u7533\u8BF7\u7ED3\u679C",subTitle:"\u6D41\u7A0B\u7ED3\u675F\u540E\uFF0C\u5BF9\u7533\u8BF7\u4EBA\u53D1\u8D77\u4EBA\u8FDB\u884C\u7533\u8BF7\u7ED3\u679C\u901A\u77E5\uFF0C\u5305\u542B\uFF1A\u5DF2\u901A\u8FC7\u3001\u5DF2\u62D2\u7EDD"},{key:"",title:"\u6284\u9001",subTitle:"\u5F53\u6284\u9001\u8282\u70B9\u6709\u65B0\u7684\u6284\u9001\u65F6\uFF0C\u5BF9\u8282\u70B9\u4E2D\u8BBE\u7F6E\u7684\u88AB\u6284\u9001\u4EBA\u8FDB\u884C\u901A\u77E5"},{key:"",title:"\u56DE\u9000",subTitle:"\u5F53\u5DF2\u529E\u6216\u7533\u8BF7\u88AB\u56DE\u9000\u65F6\uFF0C\u5C06\u5BF9\u88AB\u56DE\u9000\u7684\u8282\u70B9\u8D1F\u8D23\u4EBA\u6216\u7533\u8BF7\u4EBA\u8FDB\u884C\u63D0\u9192"},{key:"",title:"\u50AC\u529E",subTitle:"\u88AB\u50AC\u529E\u65F6\uFF0C\u5C06\u5BF9\u5F53\u524D\u6D41\u7A0B\u8282\u70B9\u7684\u8D1F\u8D23\u4EBA\u8FDB\u884C\u63D0\u9192"},{key:"",title:"\u7559\u8A00",subTitle:"\u5BF9\u5728\u7559\u8A00\u4E2D\u88AB@\u7684\u6210\u5458\u8FDB\u884C\u63D0\u9192"},{key:"",title:"\u8D85\u65F6\u9884\u8B66\u63D0\u9192",subTitle:"\u4EE3\u529E\u4E2D\u7684\u8D85\u65F6\u9884\u8B66\u63D0\u9192\u6761\u4EF6\u89E6\u53D1\u540E\uFF0C\u901A\u8FC7\u7B2C\u4E09\u65B9\u5E73\u53F0\u53CA\u90AE\u4EF6\u5BF9\u6307\u5B9A\u4EBA\u8FDB\u884C\u63D0\u9192"},{key:"",title:"\u8D85\u65F6\u63D0\u9192",subTitle:"\u5F85\u529E\u4E2D\u7684\u8D85\u65F6\u63D0\u9192\u6761\u4EF6\u89E6\u53D1\u540E\uFF0C\u901A\u8FC7\u7B2C\u4E09\u65B9\u5E73\u53F0\u53CA\u90AE\u4EF6\u5BF9\u6307\u5B9A\u4EBA\u8FDB\u884C\u63D0\u9192"}],renderItem:function(s){return(0,e.jsxs)(be.Z.Item,{children:[(0,e.jsx)(be.Z.Item.Meta,{title:(0,e.jsx)("b",{style:{fontSize:18},children:s.title}),description:s.subTitle}),(0,e.jsx)(Ct.Z,{defaultChecked:!0})]},s.key)}})}),(0,e.jsx)("br",{}),(0,e.jsxs)(z.Z,{title:"\u63D0\u9192\u65B9\u5F0F",bordered:!1,style:{width:"100%"},children:[(0,e.jsx)(le.Z,{onChange:function(){},defaultChecked:!0,children:"\u5FAE\u4FE1\u63D0\u9192"}),(0,e.jsx)("span",{style:{color:"#767"},children:"\u9700\u5148\u5173\u6CE8\u5FAE\u4FE1\u670D\u52A1\u53F7\u5E76\u7ED1\u5B9A\u7CFB\u7EDF\u8D26\u53F7 "}),(0,e.jsx)("a",{children:"\u5982\u4F55\u7ED1\u5B9A\uFF1F"}),(0,e.jsx)("br",{}),(0,e.jsx)(le.Z,{onChange:function(){},children:"\u90AE\u4EF6\u63D0\u9192"})]})]})},u=function(){return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(ve.Z,{justify:"center",style:{backgroundColor:"#F9FAFC",minHeight:"100%",paddingBottom:20},children:[(0,e.jsx)(ve.Z,{style:{width:260},children:o()}),(0,e.jsx)(ve.Z,{style:{width:1e3,flexDirection:"column"},children:a()})]})})};return u()}var Nt=function(){var n,l=(0,U.useModel)("@@initialState"),o=l.initialState,a=(0,U.useParams)(),u=(0,D.useState)(!1),i=A()(u,2),d=i[0],s=i[1],F=(0,D.useState)({}),c=A()(F,2),f=c[0],g=c[1],j=(0,D.useState)("design"),M=A()(j,2),E=M[0],C=M[1],B=(0,D.useState)({}),X=A()(B,2),y=X[0],w=X[1],W=(0,D.useState)(),te=A()(W,2),S=te[0],Le=te[1],Tt=(0,D.useState)(!1),ke=A()(Tt,2),It=ke[0],ue=ke[1],$e=D.useRef(null);function Mt(){return Ee.apply(this,arguments)}function Ee(){return Ee=I()(m()().mark(function N(){var p,Z;return m()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,xe({flowName:S.name,remark:S.name});case 2:if(p=R.sent,!(p&&p.status===0)){R.next=7;break}return R.abrupt("return",(Z=p.data)===null||Z===void 0?void 0:Z.flowModuleId);case 7:J.ZP.error("\u6D41\u7A0B\u521D\u59CB\u5316\u5931\u8D25"),console.error(p,p==null?void 0:p.msg,p==null?void 0:p.data.errMsg);case 9:case"end":return R.stop()}},N)})),Ee.apply(this,arguments)}function Zt(){return we.apply(this,arguments)}function we(){return we=I()(m()().mark(function N(){var p,Z,v,R,b;return m()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.prev=0,P.next=3,(0,G.nC)(a.id);case 3:if(p=P.sent,Z=A()(p.data,1),v=Z[0],Le(v),!v.flowModuleId){P.next=13;break}return P.next=10,ge({flowModuleId:v.flowModuleId});case 10:R=P.sent,b=R.data,w(b);case 13:P.next=18;break;case 15:P.prev=15,P.t0=P.catch(0),console.error("\u83B7\u53D6\u6D41\u7A0B\u6570\u636E\u65F6\u53D1\u751F\u9519\u8BEF:",P.t0);case 18:case"end":return P.stop()}},N,null,[[0,15]])})),we.apply(this,arguments)}(0,D.useEffect)(function(){function N(){return p.apply(this,arguments)}function p(){return p=I()(m()().mark(function Z(){var v;return m()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,(0,G.Xv)({id:a.id});case 3:v=b.sent,v&&v.data&&v.data.schema?g(JSON.parse(v.data.schema)):g({}),b.next=11;break;case 7:b.prev=7,b.t0=b.catch(0),console.error("\u83B7\u53D6\u8868\u5355schema\u65F6\u53D1\u751F\u9519\u8BEF:",b.t0),g({});case 11:case"end":return b.stop()}},Z,null,[[0,7]])})),p.apply(this,arguments)}N(),Zt()},[]);var Ue=(0,U.getLocale)(),At=function(p){if(It){Ne.Z.warning({content:"\u68C0\u6D4B\u5230\u5F53\u524D\u6709\u672A\u4FDD\u5B58\u7684\u5185\u5BB9\uFF0C\u8BF7\u5728\u8FDB\u884C\u4E0B\u4E00\u6B65\u64CD\u4F5C\u4E4B\u524D\u4FDD\u5B58\uFF01"});return}C(p)};function We(){return Ce.apply(this,arguments)}function Ce(){return Ce=I()(m()().mark(function N(){var p;return m()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,(0,G.bF)({id:a.id,schema:JSON.stringify(f)});case 3:p=v.sent,p&&p.status===0?(_.Am.success("\u4FDD\u5B58\u6210\u529F","\u63D0\u793A"),C("flowDesign"),ue(!1)):_.Am.error("\u4FDD\u5B58\u5931\u8D25","\u63D0\u793A"),v.next=11;break;case 7:v.prev=7,v.t0=v.catch(0),console.error("\u4FDD\u5B58\u65F6\u53D1\u751F\u9519\u8BEF:",v.t0),_.Am.error("\u4FDD\u5B58\u5931\u8D25","\u63D0\u793A");case 11:case"end":return v.stop()}},N,null,[[0,7]])})),Ce.apply(this,arguments)}function Ot(){return Se.apply(this,arguments)}function Se(){return Se=I()(m()().mark(function N(){var p,Z,v;return m()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(p=S.flowModuleId,S.flowModuleId){b.next=10;break}return b.next=4,Mt();case 4:return p=b.sent,Le(h()(h()({},S),{},{flowModuleId:p})),b.next=8,(0,G.FG)({id:S.id,flowModuleId:p});case 8:Z=b.sent,!Z||Z.status!==0?console.error("\u6D41\u7A0B\u6570\u636E\u672A\u6210\u529F\u7ED1\u5B9A\u8868\u5355"):(J.ZP.success("\u4FDD\u5B58\u6210\u529F"),ue(!1));case 10:return b.next=12,Fe({flowModuleId:p,flowModel:y.flowModel});case 12:v=b.sent,v&&v.status===0?(J.ZP.success("\u4FDD\u5B58\u6210\u529F",2),ue(!1),C("config")):J.ZP.error("\u4FDD\u5B58\u5931\u8D25"+v&&v.msg,2);case 14:case"end":return b.stop()}},N)})),Se.apply(this,arguments)}var Bt=function(p){ue(!0),w(h()(h()({},y),{},{flowModel:p}))};function Rt(N){console.log("\u7F16\u8F91\u5668\u6539\u53D8\u4E86"),ue(!0),g(N)}var Lt=function(){J.ZP.success("\u4FDD\u5B58\u6210\u529F"),C("publish")};function kt(){return De.apply(this,arguments)}function De(){return De=I()(m()().mark(function N(){return m()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:Ne.Z.confirm({content:"\u662F\u5426\u53D1\u5E03\u5E94\u7528\uFF1F",onOk:function(){var v=I()(m()().mark(function b(){var $,P;return m()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,O({flowModuleId:S.flowModuleId});case 2:if($=V.sent,console.log(1,$),console.log($,y.flowModuleId),($==null?void 0:$.data.errCode)!==1e3){V.next=13;break}return V.next=8,(0,G.nY)({id:S.id});case 8:P=V.sent,J.ZP.success("\u53D1\u5E03\u6210\u529F"),(P==null?void 0:P.status)!==0&&(J.ZP.success("\u8868\u5355\u53D1\u5E03\u5931\u8D25"),console.log(P)),V.next=15;break;case 13:J.ZP.error("\u53D1\u5E03\u5931\u8D25"),console.log($,$==null?void 0:$.data.errMsg);case 15:case"end":return V.stop()}},b)}));function R(){return v.apply(this,arguments)}return R}()});case 1:case"end":return Z.stop()}},N)})),De.apply(this,arguments)}return(0,e.jsxs)("div",{className:"Editor",children:[(0,e.jsx)(Et,{current:E,steps:[{key:"design",title:"\u8868\u5355\u8BBE\u8BA1",extra:(0,e.jsxs)(e.Fragment,{children:[!d&&(0,e.jsx)(x.jEJ,{}),(0,e.jsx)(K.ZP,{title:d?"\u7F16\u8F91":"\u9884\u89C8",onClick:function(){return s(!d)},children:d?"\u7F16\u8F91":"\u9884\u89C8"}),(0,e.jsx)(K.ZP,{type:"primary",title:"\u4FDD\u5B58",onClick:We,children:"\u4FDD\u5B58\u5E76\u4E0B\u4E00\u6B65"})]})},{key:"flowDesign",title:"\u6DFB\u52A0\u6D41\u7A0B",extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(K.ZP,{type:"primary",title:"\u4FDD\u5B58",onClick:Ot,children:"\u4FDD\u5B58\u5E76\u4E0B\u4E00\u6B65"})})},{key:"config",title:"\u6269\u5C55\u8BBE\u7F6E",extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(K.ZP,{type:"primary",title:"\u4FDD\u5B58",onClick:Lt,children:"\u4FDD\u5B58\u5E76\u4E0B\u4E00\u6B65"})})},{key:"publish",title:"\u53D1\u5E03"}],onChange:At,renderExtra:function(p){return(0,e.jsxs)(e.Fragment,{children:[p,(0,e.jsx)(K.ZP,{title:"\u9000\u51FA",onClick:window.close,children:"\u9000\u51FA"})]})}}),(0,e.jsxs)("div",{className:"Editor-inner",ref:$e,children:[E==="design"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(_.qR,{theme:"cxd",position:"top-center",locale:Ue},"toast"),(0,e.jsx)(_.wx,{theme:"cxd",locale:Ue},"alert"),(0,e.jsx)(x.MLE,{theme:"cxd",preview:d,value:f,onChange:Rt,onPreview:function(){s(!0)},onSave:We,className:"is-fixed",showCustomRenderersPanel:!0,amisEnv:{fetcher:L._,alert:_.Z9,copy:Ke(),confirm:_.M6},data:{permsCode:o==null||(n=o.currentUser)===null||n===void 0?void 0:n.permsCode}})]}),E==="flowDesign"&&(0,e.jsx)("div",{className:"flowDesign-form",style:{height:"100%"},children:(0,e.jsx)(Ft,{changeFlowModel:Bt,flowData:y})}),E==="config"&&(0,e.jsx)("div",{className:"config-form",style:{height:"100%"},children:(0,e.jsx)(Dt,{container:$e.current})}),E==="publish"&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(z.Z,{styles:{body:{height:"100%"}},style:{width:800,height:300,margin:"20px auto"},children:(0,e.jsxs)(Ve.Z,{style:{height:"100%"},children:[(0,e.jsx)(Pe.Z,{span:12,style:{display:"flex",justifyContent:"space-evenly",alignItems:"center"},children:(0,e.jsx)(ze.Z,{description:!1})}),(0,e.jsxs)(Pe.Z,{span:12,style:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},children:[(0,e.jsxs)("span",{style:{fontSize:20,fontWeight:900},children:[(S==null?void 0:S.flowModuleId)&&"\u5E94\u7528\u51C6\u5907\u5C31\u7EEA\uFF0C\u7ACB\u523B\u53D1\u5E03\uFF01",!(S!=null&&S.flowModuleId)&&"\u6D41\u7A0B\u672A\u914D\u7F6E\uFF0C\u8BF7\u5148\u6DFB\u52A0\u6D41\u7A0B\uFF01"]}),(S==null?void 0:S.flowModuleId)&&(0,e.jsx)(K.ZP,{onClick:kt,style:{width:200,color:"#FFFFFF",backgroundColor:"#FB9337"},children:"\u53D1\u5E03\u5E94\u7528"}),!(S!=null&&S.flowModuleId)&&(0,e.jsx)(K.ZP,{onClick:function(){return C("flowDesign")},style:{width:200},children:"\u6DFB\u52A0\u6D41\u7A0B"})]})]})})})]})]})},Pt=Nt},47448:function(){}}]);
